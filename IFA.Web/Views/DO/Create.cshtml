
@{
    ViewData["Title"] = "Create SO";
    Layout = "~/Views/Shared/_Layout.cshtml";
}


<script type="text/javascript">

    var urlGetPaketList = '@Url.Action("GetPaketList", "DO")';
    var urlGetCustomer = '@Url.Action("GetCustomer", "DO")';
    var urlGetPaket = '@Url.Action("GetPaket", "DO")';
    var urlGetHargaBarang = '@Url.Action("GetHargaBarang", "DO")';
    var urlGetKasir = '@Url.Action("GetKasir1", "DO")';
    var urlSave = '@Url.Action("Save", "DO")';
    var urlCreate = '@Url.Action("Create", "DO")';
    var Mode = '@ViewBag.Mode';
    var idDO = '@ViewBag.Id';
    var urlGetData = '@Url.Action("GetDO", "DO")';
    var salesID = '@ViewBag.salesID';
    var urlGetIndenDO = '@Url.Action("GetIndenDOCreate", "DO")';
    var urlGetLimit = '@Url.Action("GetDOLimit", "DO")';
    var BranchID = '@ViewBag.BranchID';
    var urlGetDataRetur = '@Url.Action("GetDORetur", "DO")';
    var urlSaveRetur = '@Url.Action("SaveRetur", "DO")';
    var urlPrintDOToko = '@Url.Action("GetDOToko", "DO")';
    var urlPrintDOKairos = '@Url.Action("GetDOKairos", "DO")';
    var urlPrintNota = '@Url.Action("GetDONota", "DO")';
    var urlCheckGudang = '@Url.Action("StokGudang", "Inventory")';
    var urlGetDetailStok = '@Url.Action("GetDetailStokGudang", "Inventory")';
    var urlSaveCustomer = '@Url.Action("SaveCustomer", "DO")';
    var urlPrintNotaNew = '@Url.Action("GetDONotaNew", "DO")';
    var akses_penjualan = '@ViewBag.akses_penjualan';
    var urlGetPiutangCustomer = '@Url.Action("GetPiutangCustomer", "DO")';
    var urlEdit = '@Url.Action("Edit", "DO")';
    var urlGetDPInden = '@Url.Action("GetDPInden", "DO")';
    var urlGetAuth = '@Url.Action("GetAuth", "DO")';

</script>

<script src="~/content/printmanager/zip.js-master/zip.js"></script>
<script src="~/content/printmanager/zip.js-master/zip-ext.js"></script>
<script src="~/content/printmanager/zip.js-master/deflate.js"></script>
<script src="~/content/printmanager/JSPrintManager.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bluebird/3.3.5/bluebird.min.js"></script>
@*<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>*@
<script src="~/Script/DO/Create.js" asp-append-version="true"></script>

<style>
    .red1 {
        background-color: red;
        color: black;
    }

   
    .k-group-footer {
        text-align: right;
    }

</style>

<div class="panel panel-default" id="createForm">
    <div class="panel-heading">
        <div class="col-md-12 paddingleft0 divTitle">
            <div class="col-md-4 paddingleft5 ">
                <h6 class="panel-title">
                    FORM Penjualan
                </h6>
            </div>

            <div class=" floatright" style="float:right;">

            </div>
        </div>
    </div>

    @using (Html.BeginForm("Save", "DO", FormMethod.Post, new { id = "form1" }))
    {
        <div class="" style="min-height:450px;">
            <div class="panel-body page-content  container-fluid request-viewrequest" style="margin-left:0px;">
                <div class="col-xs-12 col-sm-9 col-lg-11 page-left-content" style="min-height:450px;">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="col-md-6">
                                <div class="col-xs-12 col-sm-9 col-lg-12 form-c-inline">
                                    <div class="row">
                                        <label class="col-md-2 col-form-label">DO Number<span class="red">*</span></label>
                                        <div class="col-md-10">
                                            <input class="form-control inputPink" value="AUTO GENERATED" id="DONumber" disabled />
                                        </div>
                                    </div>
                                </div>

                                <div class="col-xs-12 col-sm-9 col-lg-12 form-c-inline">
                                    <div class="row">
                                        <label class="col-md-2 col-form-label">Jenis DO<span class="red">*</span></label>
                                        <div class="col-md-10">
                                            @if (ViewBag.BranchID == "TOKO" || ViewBag.akses_penjualan == "CASH")
                                            {
                                                <select name="jenisDO" id="jenisDO" class="selectpicker width99 inputGreen" data-live-search="true" onchange="onjenisDOChanged()">
                                                    <option value="CASH">CASH</option>
                                                    <option value="NON CASH">NON CASH</option>
                                                </select>
                                            }
                                            else
                                            {
                                                <select name="jenisDO" id="jenisDO" class="selectpicker width99 inputGreen" data-live-search="true">
                                                    <option value="NON CASH">NON CASH</option>
                                                </select>
                                            }

                                        </div>
                                    </div>
                                </div>
                                <div class="col-xs-12 col-sm-9 col-lg-12 form-c-inline" style="display:none">
                                    <div class="row">
                                        <label class="col-md-2 col-form-label">Sales<span class="red">*</span></label>
                                        <div class="col-md-10">
                                            <select name="kasir" id="kasir" class="selectpicker width99 inputGreen" data-live-search="true">
                                            </select>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-xs-12 col-sm-9 col-lg-12 form-c-inline">
                                    <div class="row">
                                        <label class="col-md-2 col-form-label">Kategori<span class="red">*</span></label>
                                        <div class="col-md-10">
                                            <select name="kategori" id="kategori" class="selectpicker width99 inputGreen" data-live-search="true" onchange="changekat()">
                                                <option value="">Pilih Paket</option>
                                                <option value="URGENT">Urgent</option>
                                                <option value="TOP URGENT">Top Urgent</option>
                                                <option value="REGULER">Reguler</option>
                                                <option value="BOOKING ORDER">Booking Order</option>
                                                <option value="BO PAKET">Booking Paket</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>

                                <div id="divpaket" class="col-xs-12 col-sm-9 col-lg-12 form-c-inline">
                                    <div class="row">
                                        <label class="col-md-2 col-form-label">Paket<span class="red">*</span></label>
                                        <div class="col-md-10">
                                            <select name="paket" id="paket" class="selectpicker width99 inputGreen" data-live-search="true" onchange="onChangePaket();">
                                            </select>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-xs-12 col-sm-9 col-lg-12 form-c-inline">
                                    <div class="row">
                                        <label class="col-md-2 col-form-label">Tanggal DO<span class="red">*</span></label>
                                        <div class="col-xs-12 col-sm-9 col-lg-4">
                                            <div class='input-group date' id="divtanggal">
                                                <input id='tanggal' type='text' class="form-control datepicker" value="" />
                                                <span class="input-group-addon">
                                                    <span class="glyphicon glyphicon-calendar"></span>
                                                </span>
                                            </div>
                                        </div>
                                        <label class="col-md-1 col-form-label">&nbsp; &nbsp; Kirim</label>
                                        <div class="col-xs-12 col-sm-9 col-lg-4">
                                            <div class='input-group date' id="divtanggalkirim">
                                                <input id='tanggalkirim' type='text' class="form-control datepicker" value="" />
                                                <span class="input-group-addon">
                                                    <span class="glyphicon glyphicon-calendar"></span>
                                                </span>
                                            </div>
                                        </div>

                                    </div>
                                </div>
                                <div class="col-xs-12 col-sm-9 col-lg-12 form-c-inline" id="divdp" style="display:none;">
                                    <div class="row">
                                        <label class="col-md-2 col-form-label">DP Inden</label>
                                        <div class="col-md-10">
                                            <input class="form-control" value="" id="dp_inden" type="number" disabled />
                                        </div>

                                    </div>
                                </div>
                                <div class="col-xs-12 col-sm-9 col-lg-12 form-c-inline" id="divdp" style="display:none;">
                                    <div class="row">
                                        <label class="col-md-2 col-form-label">DP</label>
                                        <div class="col-md-10">
                                            <input class="form-control" value="" id="dp" type="number" />
                                        </div>

                                    </div>
                                </div>



                                @*<div class="col-xs-12 col-sm-9 col-lg-12 form-c-inline">
                                        <div class="row">
                                            <label class="col-md-2 col-form-label">No Ref 2</label>
                                            <div class="col-md-10">
                                                <input class="form-control" value="" id="RefNo2" />
                                            </div>

                                        </div>
                                    </div>*@
                                <div class="col-xs-12 col-sm-9 col-lg-12 form-c-inline">
                                    <div class="row">
                                        <label class="col-md-2 col-form-label">Printer</label>
                                        <div class="col-md-10">
                                            <select name="installedPrinterName" id="installedPrinterName" class="form-control"></select>
                                            <input class="styled " type="checkbox" id="useDefaultPrinter">
                                            <label for="useDefaultPrinter" class="">
                                                Default Printer
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-6">
                                <div class="col-xs-12 col-sm-9 col-lg-12 form-c-inline">
                                    <div class="row">
                                        <label class="col-md-2 col-form-label">Customer<span class="red">*</span></label>
                                        <div class="col-md-10">
                                            <select name="Kd_Customer" id="Kd_Customer" class="selectpicker width99 inputGreen" data-live-search="true" onchange="onCustomerChanged()"></select>
                                            <button id="addCustomer" type="button" class="btn btn-primary" data-toggle="modal" onclick="opencustomerModal(); return false;" data-target="#customerModal" data-dismiss="modal"><i class="glyphicon glyphicon-plus"></i></button>
                                            <button id="viewPiutang" type="button" class="btn btn-info" data-toggle="modal" onclick="opencustomerPiutangModal(); return false;" data-target="#customerPiutangModal" data-dismiss="modal">Piutang</button>

                                        </div>
                                    </div>
                                </div>

                                <div class="col-xs-12 col-sm-9 col-lg-12 form-c-inline">
                                    <div class="row">
                                        <label class="col-md-2 col-form-label">Limit Piutang</label>
                                        <div class="col-md-10">
                                            <input class="form-control" value="" id="lim_piu" disabled />
                                        </div>

                                    </div>
                                </div>

                                <div class="col-xs-12 col-sm-9 col-lg-12 form-c-inline">
                                    <div class="row">
                                        <label class="col-md-2 col-form-label">Alamat Kirim<span class="red">*</span></label>
                                        <div class="col-md-10">
                                            <textarea class="form-control" rows="3" id="AlamatKirim" name="AlamatKirim" style="resize:none;max-width:100%"></textarea>
                                        </div>
                                    </div>
                                </div>




                                <div class="col-xs-12 col-sm-9 col-lg-12 form-c-inline">
                                    <div class="row">
                                        <label class="col-md-2 col-form-label">Status</label>
                                        <div class="col-md-4">
                                            <input class="form-control inputPink" value="NEW" id="Status" disabled />
                                        </div>

                                    </div>
                                    <div class="col-xs-12 col-sm-9 col-lg-12 form-c-inline">
                                        <div class="row">
                                            <label class="col-md-2 col-form-label">No Ref 1</label>
                                            <div class="col-xs-12 col-sm-9 col-lg-4">
                                                <input class="form-control" value="" id="RefNo1" />
                                            </div>
                                            <label class="col-md-1 col-form-label">&nbsp; &nbsp;Ref 2</label>
                                            <div class="col-xs-12 col-sm-9 col-lg-4">
                                                <input class="form-control" value="" id="RefNo2" />
                                            </div>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-12 col-sm-9 col-lg-12 form-c-inline">
                        <div class="row">
                            <div class="col-md-6">

                            </div>
                            <div class="col-md-6">
                                @if (ViewBag.Mode != "VIEW")
                                {
                                    <button id="addKota" class="btn btn-primary pull-right" onclick="onAddNewRow(); return false;"><i class="glyphicon glyphicon-plus"></i>&nbsp; Tambah Item(F2)</button>
                                    <button id="addDPM" type="button" data-toggle="modal" data-target="#requestModal" onclick="onAddNewDPM(); return false;" class="btn btn-info pull-right " style="margin-right:10px;display:none" data-dismiss="modal"><i class="glyphicon glyphicon-plus"></i>&nbsp; Inden</button>
                                    @*@if (ViewBag.akses_penjualan == "NON CASH")
                                        {
                                            <button id="addDPM" type="button" data-toggle="modal" data-target="#requestModal" onclick="onAddNewDPM(); return false;" class="btn btn-info pull-right " style="margin-right:10px;" data-dismiss="modal"><i class="glyphicon glyphicon-plus"></i>&nbsp; Inden</button>
                                        }*@

                                }
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-12">
                            <div id="GridDO"></div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            <div class="col-md-6">
                                <div class="col-xs-12 col-sm-9 col-lg-12 form-c-inline" id="divjt">
                                    <div class="row">
                                        <label class="col-md-2 col-form-label">Jatuh Tempo</label>
                                        <div class="col-md-10">
                                            <input class="form-control" value="0" min="0" oninput="validity.valid||(value='');" id="jt" type="number" required />
                                        </div>

                                    </div>
                                </div>

                                <div class="col-xs-12 col-sm-9 col-lg-12 form-c-inline">
                                    <div class="row">
                                        <label class="col-md-2 col-form-label">Keterangan</label>
                                        <div class="col-md-10">
                                            <textarea class="form-control" rows="3" id="Keterangan" name="Keterangan" style="resize:none;max-width:100%">-</textarea>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="col-xs-12 col-sm-9 col-lg-12 form-c-inline ">
                                    <div class="row">
                                        <label class="col-md-6 col-form-label" style="text-align:right">SubTotal</label>
                                        <div class="col-md-6">
                                            <input class="form-control pull-right inputPink text-right" value="0" id="SubTotal" disabled />
                                        </div>
                                    </div>
                                </div>
                                @if (ViewBag.BranchID == "TOKO" || ViewBag.akses_penjualan == "CASH")
                                {
                                    <div class="col-xs-12 col-sm-9 col-lg-12 form-c-inline ">
                                        <div class="row">
                                            <label class="col-md-6 col-form-label" style="text-align:right;">Diskon</label>
                                            <div class="col-md-6">
                                                <input class="form-control pull-right inputPink text-right" value="0" id="Diskon" disabled />
                                            </div>
                                        </div>
                                    </div>
                                }
                                else
                                {
                                    <div class="col-xs-12 col-sm-9 col-lg-12 form-c-inline " style="display:none;">
                                        <div class="row">
                                            <label class="col-md-6 col-form-label" style="text-align:right;">Diskon</label>
                                            <div class="col-md-6">
                                                <input class="form-control pull-right inputPink text-right" value="0" id="Diskon" disabled />
                                            </div>
                                        </div>
                                    </div>
                                }

                                <div class="col-xs-12 col-sm-9 col-lg-12 form-c-inline" style="display:none">
                                    <div class="row">
                                        <label class="col-md-6 col-form-label" style="text-align:right">Jasa Kirim</label>
                                        <div class="col-md-6">
                                            <div class="col-md-6">

                                                <div class="col-md-2 checkbox checkbox-primary paddingleft42">
                                                    <input id="cb_ongkir" class="styled " type="checkbox">
                                                    <label for="cb_ongkir" class="">
                                                        EXCLUDE ongkir
                                                    </label>
                                                </div>

                                            </div>
                                            <div class="col-md-6">
                                                <input class="form-control pull-right text-right" value="" id="ongkir" type="number" />
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-xs-12 col-sm-9 col-lg-12 form-c-inline">
                                    <div class="row">
                                        <label class="col-md-6 col-form-label" style="text-align:right">Flag PPN</label>
                                        <div class="col-md-2 checkbox checkbox-primary" style="padding-left:30px">
                                            <input id="checkbox2" class="styled " type="checkbox">
                                            <label for="checkbox2" class="">
                                                PPN
                                            </label>
                                        </div>
                                        <div class="col-md-4">

                                            <input class="form-control pull-right inputGreen text-right" value="0" id="PPN" disabled onkeyup="ItemCalc();" />
                                        </div>

                                    </div>
                                </div>

                                <div class="col-xs-12 col-sm-9 col-lg-12 form-c-inline">
                                    <div class="row">
                                        <label class="col-md-6 col-form-label" style="text-align:right">Total Rupiah</label>
                                        <div class="col-md-6">
                                            <input class="form-control pull-right inputPink text-right" value="0" id="TotalRupiah" disabled />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-xs-12 col-sm-3 col-lg-1 page-right-content">
                    <div class=" row-navandbuttons">
                        <div class="col-xs-12">
                            <div id="right-content-buttons" class=" right-buttons">
                                <div class="col-xs-12">
                                    <div class=" ">
                                        <div class="col-xs-6 col-sm-12 row-right-button" style="text-align: left;margin-top: 126px;">
                                            <button id="back" class="btn btn-success right-button" onclick="showCreate(); return false;"><i class="glyphicon glyphicon-file paddingRight10" aria-hidden="true"></i><span>NEW(F7)</span></button>
                                        </div>
                                        @if (ViewBag.Mode == "EDIT" || ViewBag.Mode == "NEW" || ViewBag.Mode == "RETUR")
                                        {
                                            <div class="col-xs-6 col-sm-12 row-right-button" style="text-align: left;">
                                                <button id="save" class="btn btn-primary right-button" onclick="onSaveClicked(); return false;"><i class="glyphicon glyphicon-floppy-disk paddingRight10" aria-hidden="true"></i><span>Simpan(F4)</span></button>
                                            </div>
                                        }

                                        @if (ViewBag.Mode == "EDIT" || ViewBag.Mode == "VIEW")
                                        {
                                            @if (ViewBag.BranchID == "GROSIR" && ViewBag.akses_penjualan != "CASH")
                                            {
                                                @*<div class="col-xs-6 col-sm-12 row-right-button" style="text-align: left;">
                                                        <button id="print" class="btn btn-success right-button" onclick="onPrintClickedDO(); return false;"><i class="glyphicon glyphicon-print paddingRight10" aria-hidden="true"></i><span>Print DO</span></button>
                                                    </div>*@
                                                <div class="col-xs-6 col-sm-12 row-right-button" style="text-align: left;">
                                                    <button id="printdonew" type="button" class="btn btn-success right-button" onclick="printDONew(); return false;"><i class="glyphicon glyphicon-print paddingRight10" aria-hidden="true"></i><span>Print DO</span></button>
                                                </div>
                                                //printSJKairosNew
                                                @*<div class="col-xs-6 col-sm-12 row-right-button" style="text-align: left;">
                                                        <button id="print1" class="btn btn-success right-button" onclick="printSJKairosNew(); return false;"><i class="glyphicon glyphicon-print paddingRight10" aria-hidden="true"></i><span>Print SJ</span></button>
                                                    </div>*@
                                                @*<div class="col-xs-6 col-sm-12 row-right-button" style="text-align: left;">
                                                        <button id="print1" class="btn btn-success right-button" onclick="onPrintClicked(); return false;"><i class="glyphicon glyphicon-print paddingRight10" aria-hidden="true"></i><span>Print SJ</span></button>
                                                    </div>*@
                                                @*<div class="col-xs-6 col-sm-12 row-right-button" style="text-align: left;">
                                                        <button id="print2" class="btn btn-success right-button" onclick="onPrintClickedFaktur(); return false;"><i class="glyphicon glyphicon-print paddingRight10" aria-hidden="true"></i><span>Print Faktur</span></button>
                                                    </div>*@
                                            }
                                            else
                                            {
                                                @*<div class="col-xs-6 col-sm-12 row-right-button" style="text-align: left;">
                                                        <button id="print" class="btn btn-success right-button" onclick="onPrintDOTokoClicked(); return false;"><i class="glyphicon glyphicon-print paddingRight10" aria-hidden="true"></i><span>Print SJ</span></button>
                                                    </div>
                                                    <div class="col-xs-6 col-sm-12 row-right-button" style="text-align: left;">
                                                        <button id="print1" class="btn btn-success right-button" onclick="onPrintClickedNota(); return false;"><i class="glyphicon glyphicon-print paddingRight10" aria-hidden="true"></i><span>Print Nota</span></button>
                                                    </div>*@
                                                <div class="col-xs-6 col-sm-12 row-right-button" style="text-align: left;">
                                                    <button id="printnew" type="button" class="btn btn-success right-button" onclick="printNotaNew(); return false;"><i class="glyphicon glyphicon-print paddingRight10" aria-hidden="true"></i><span>Print Nota</span></button>
                                                </div>
                                                <div class="col-xs-6 col-sm-12 row-right-button" style="text-align: left;">
                                                    <button id="printsjnew" type="button" class="btn btn-success right-button" onclick="printSJNew(); return false;"><i class="glyphicon glyphicon-print paddingRight10" aria-hidden="true"></i><span>Print SJ</span></button>
                                                </div>
                                            }
                                        }
                                        @if ((ViewBag.Mode == "EDIT" || ViewBag.Mode == "NEW" || ViewBag.Mode == "RETUR") && (ViewBag.BranchID == "TOKO" || ViewBag.akses_penjualan == "CASH"))
                                        {
                                            <div class="col-xs-6 col-sm-12 row-right-button" style="text-align: left;">
                                                <button id="pembatalan" type="button" class="btn btn-danger right-button" data-toggle="modal" data-target="#returModal" data-dismiss="modal" onclick="showRetur(); return false;"><i class="glyphicon glyphicon-file paddingRight10" aria-hidden="true"></i><span>Retur(F8)</span></button>
                                            </div>
                                        }

                                        <div class="col-xs-6 col-sm-12 row-right-button" style="text-align: left;">
                                            <button id="stok" type="button" class="btn btn-danger right-button" onclick="showStok(); return false;"><i class="glyphicon glyphicon-file paddingRight10" aria-hidden="true"></i><span>Stok</span></button>
                                        </div>



                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row row-navigatortoggler">
                        <div class="col-xs-12 row-right-button">
                            <button class="btn btn-default" data-toggle="collapse" data-target="#right-content-navigator, #right-content-buttons" onclick="return false;">
                                <span>
                                    <img src="~/images/expand-navigation-icon.png" class="navigatortoggler-icon">
                                </span>
                            </button>
                        </div>
                    </div>

                </div>
            </div>
        </div>
        <div class="modal fade in" id="requestModal" tabindex="-1" role="dialog" aria-labelledby="requestModal" aria-hidden="true">
            <div class="vertical-alignment-helper">
                <div class="modal-dialog vertical-align-center">
                    <div class="modal-content" style="max-width:90%">
                        <div class="modal-header">
                            <h4 class="modal-title" id="answerModalLabel">Inden</h4>

                            <button type="button" class="close" data-dismiss="modal">
                                <span aria-hidden="true">&times;</span><span class="sr-only">Close</span>
                            </button>

                        </div>
                        <div class="modal-body">
                            <div class="col-md-12 form-c-inline">
                                <div class="row">
                                    <div class="col-md-12">
                                        <div id="DPMGrid"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                            <button type="button" onclick="tambahDPM(); return false;" class="btn btn-primary">Save changes</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>


        <div class="modal fade in" id="requestModal1" tabindex="-1" role="dialog" aria-labelledby="requestModal1" aria-hidden="true">
            <div class="vertical-alignment-helper">
                <div class="modal-dialog modal-dialog-scrollable vertical-align-center" role="document">
                    <div class="modal-content" style="max-width:90%">
                        <div class="modal-header">
                            <h4 class="modal-title" id="answerModalLabel">PIUTANG LEBIH LIMIT / PIUTANG JATUH TEMPO</h4>
                            


                        </div>
                        <div class="modal-body">
                            <div class="col-md-12 form-c-inline">
                                <div class="row">
                                    <div class="col-md-12">
                                        <h3 id="teksjudul"></h3>
                                        <div id="DPMLimit"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" onclick="closemodal(); return false;" class="btn btn-default" data-dismiss="modal">Close</button>
                            <button type="button" onclick="ProsesOtp1(); return false;" class="btn btn-primary">Password</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade in" id="returModal" tabindex="-1" role="dialog" aria-labelledby="returModal" aria-hidden="true">
            <div class="vertical-alignment-helper">
                <div class="modal-dialog vertical-align-center">
                    <div class="modal-content" style="max-width:90%">
                        <div class="modal-header">
                            <h4 class="modal-title" id="answerModalLabel">RETUR</h4>

                            <button type="button" class="close" data-dismiss="modal">
                                <span aria-hidden="true">&times;</span><span class="sr-only">Close</span>
                            </button>

                        </div>
                        <div class="modal-body">
                            <div class="col-md-12 form-c-inline">
                                <div class="row">
                                    <div class="col-md-12">
                                        <input class="form-control" value="" placeholder="Filter No" id="txtNo" onkeyup="filterChanged()" />

                                        <div id="GridRetur"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                            <button type="button" onclick="tambahRetur(); return false;" class="btn btn-primary">Save changes</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal fade in" id="StokModal" tabindex="-1" role="dialog" aria-labelledby="StokModal" aria-hidden="true">
            <div class="vertical-alignment-helper">
                <div class="modal-dialog vertical-align-center">
                    <div class="modal-content" style="max-width:90%">
                        <div class="modal-header">
                            <h4 class="modal-title" id="answerModalLabel">STOK GUDANG</h4>

                            <button type="button" class="close" data-dismiss="modal">
                                <span aria-hidden="true">&times;</span><span class="sr-only">Close</span>
                            </button>

                        </div>
                        <div class="modal-body">
                            <div class="col-md-12 form-c-inline">
                                <div class="row">
                                    <div class="col-md-12">
                                        @*<input class="form-control" value="" placeholder="Filter No" id="txtNo" onkeyup="filterChanged()" />*@

                                        <div id="GridDetailGudangStock"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                            <button type="button" onclick="tambahRetur(); return false;" class="btn btn-primary">Save changes</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade in" id="otpModal" tabindex="-1" role="dialog" aria-labelledby="otpModal" aria-hidden="true">
            <div class="vertical-alignment-helper">
                <div class="modal-dialog vertical-align-center">
                    <div class="modal-content" style="max-width:40%">
                        <div class="modal-header">
                            <h4 class="modal-title" id="answerModalLabel">OTP Password</h4>

                            @*<button type="button" class="close" data-dismiss="modal">
                                    <span aria-hidden="true">&times;</span><span class="sr-only">Close</span>
                                </button>*@

                        </div>
                        <div class="modal-body">
                            <div class="col-md-12 form-c-inline">
                                <div class="row">
                                    <div class="col-md-12">
                                        <div class="col-xs-12 col-sm-9 col-lg-12 form-c-inline">
                                            <div class="row">
                                                <label class="col-md-2 col-form-label">Password</label>
                                                <div class="col-md-10">
                                                    <input class="form-control" type="password" value="" name="otp" id="otp" />
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">

                            <button type="button" onclick="ValidasiOtp(); return false;" class="btn btn-primary">Proccess</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

  

        <div class="modal fade in" id="customerModal" tabindex="-1" role="dialog" aria-labelledby="customerModal" aria-hidden="true">
            <div class="vertical-alignment-helper">
                <div class="modal-dialog vertical-align-center">
                    <div class="modal-content" style="max-width:40%">
                        <div class="modal-header">
                            <h4 class="modal-title" id="answerModalLabel">Tambah Customer</h4>

                            <button type="button" class="close" data-dismiss="modal">
                                <span aria-hidden="true">&times;</span><span class="sr-only">Close</span>
                            </button>

                        </div>
                        <div class="modal-body">
                            <div class="col-md-12 form-c-inline">
                                <div class="row">
                                    <div class="col-md-12">
                                        <div class="col-xs-12 col-sm-9 col-lg-12 form-c-inline">
                                            <div class="row">
                                                <label class="col-md-2 col-form-label">Nama</label>
                                                <div class="col-md-10">
                                                    <input class="form-control" value="" id="NamaCust" />
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-xs-12 col-sm-9 col-lg-12 form-c-inline">
                                            <div class="row">
                                                <label class="col-md-2 col-form-label">Alamat</label>
                                                <div class="col-md-10">
                                                    <textarea class="form-control" rows="3" id="AlamatCust" name="AlamatCust" style="resize:none;"></textarea>

                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-xs-12 col-sm-9 col-lg-12 form-c-inline">
                                            <div class="row">
                                                <label class="col-md-2 col-form-label">Kota</label>
                                                <div class="col-md-10">
                                                    <input class="form-control" value="" id="KotaCust" />
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-xs-12 col-sm-9 col-lg-12 form-c-inline">
                                            <div class="row">
                                                <label class="col-md-2 col-form-label">Telp</label>
                                                <div class="col-md-10">
                                                    <input class="form-control" value="" id="TelpCust" />
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                            <button type="button" onclick="tambahCustomer(); return false;" class="btn btn-primary">Save changes</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal fade in" id="customerPiutangModal" tabindex="-1" role="dialog" aria-labelledby="customerPiutangModal" aria-hidden="true">
            <div class="vertical-alignment-helper">
                <div class="modal-dialog vertical-align-center">
                    <div class="modal-content" style="max-width:70%">
                        <div class="modal-header">
                            <h4 class="modal-title" id="answerModalLabel">Customer Piutang</h4>

                            <button type="button" class="close" data-dismiss="modal">
                                <span aria-hidden="true">&times;</span><span class="sr-only">Close</span>
                            </button>

                        </div>
                        <div class="modal-body">
                            <div class="col-md-12 form-c-inline">
                                <div class="row">
                                    <div class="col-md-12">
                                        <div class="col-xs-12 col-sm-9 col-lg-12 form-c-inline">
                                            <div class="row">
                                                <div id="gvPiutangCustomer"></div>
                                            </div>
                                        </div>

                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                            <button type="button" id="btnSimpanPiutang" onclick="SaveData(); return false;" class="btn btn-primary">Lanjutkan</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    }
</div>
<script>

    //WebSocket settings
    JSPM.JSPrintManager.auto_reconnect = true;
    JSPM.JSPrintManager.start();
    JSPM.JSPrintManager.WS.onStatusChanged = function () {
        if (jspmWSStatus()) {
            //get client installed printers
            JSPM.JSPrintManager.getPrinters().then(function (myPrinters) {
                var options = '';
                for (var i = 0; i < myPrinters.length; i++) {
                    options += '<option>' + myPrinters[i] + '</option>';
                }
                $('#installedPrinterName').html(options);
            });
        }
    };

    //Check JSPM WebSocket status
    function jspmWSStatus() {
        if (JSPM.JSPrintManager.websocket_status == JSPM.WSStatus.Open)
            return true;
        else if (JSPM.JSPrintManager.websocket_status == JSPM.WSStatus.Closed) {
            //alert('JSPrintManager (JSPM) is not installed or not running! Download JSPM Client App from https://neodynamic.com/downloads/jspm');
            return false;
        }
        else if (JSPM.JSPrintManager.websocket_status == JSPM.WSStatus.BlackListed) {
            //  alert('JSPM has blacklisted this website!');
            return false;
        }
    }

    //Do printing...

</script>